<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8">
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />

<meta name="author" content="Bill Peterman" />

<meta name="date" content="2015-09-29" />

<title>ssmc User Guide</title>



<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; }
code > span.dt { color: #902000; }
code > span.dv { color: #40a070; }
code > span.bn { color: #40a070; }
code > span.fl { color: #40a070; }
code > span.ch { color: #4070a0; }
code > span.st { color: #4070a0; }
code > span.co { color: #60a0b0; font-style: italic; }
code > span.ot { color: #007020; }
code > span.al { color: #ff0000; font-weight: bold; }
code > span.fu { color: #06287e; }
code > span.er { color: #ff0000; font-weight: bold; }
</style>
<style type="text/css">
  pre:not([class]) {
    background-color: white;
  }
</style>


<link href="data:text/css,body%20%7B%0A%20%20background%2Dcolor%3A%20%23fff%3B%0A%20%20margin%3A%201em%20auto%3B%0A%20%20max%2Dwidth%3A%20700px%3B%0A%20%20overflow%3A%20visible%3B%0A%20%20padding%2Dleft%3A%202em%3B%0A%20%20padding%2Dright%3A%202em%3B%0A%20%20font%2Dfamily%3A%20%22Open%20Sans%22%2C%20%22Helvetica%20Neue%22%2C%20Helvetica%2C%20Arial%2C%20sans%2Dserif%3B%0A%20%20font%2Dsize%3A%2014px%3B%0A%20%20line%2Dheight%3A%201%2E35%3B%0A%7D%0A%0A%23header%20%7B%0A%20%20text%2Dalign%3A%20center%3B%0A%7D%0A%0A%23TOC%20%7B%0A%20%20clear%3A%20both%3B%0A%20%20margin%3A%200%200%2010px%2010px%3B%0A%20%20padding%3A%204px%3B%0A%20%20width%3A%20400px%3B%0A%20%20border%3A%201px%20solid%20%23CCCCCC%3B%0A%20%20border%2Dradius%3A%205px%3B%0A%0A%20%20background%2Dcolor%3A%20%23f6f6f6%3B%0A%20%20font%2Dsize%3A%2013px%3B%0A%20%20line%2Dheight%3A%201%2E3%3B%0A%7D%0A%20%20%23TOC%20%2Etoctitle%20%7B%0A%20%20%20%20font%2Dweight%3A%20bold%3B%0A%20%20%20%20font%2Dsize%3A%2015px%3B%0A%20%20%20%20margin%2Dleft%3A%205px%3B%0A%20%20%7D%0A%0A%20%20%23TOC%20ul%20%7B%0A%20%20%20%20padding%2Dleft%3A%2040px%3B%0A%20%20%20%20margin%2Dleft%3A%20%2D1%2E5em%3B%0A%20%20%20%20margin%2Dtop%3A%205px%3B%0A%20%20%20%20margin%2Dbottom%3A%205px%3B%0A%20%20%7D%0A%20%20%23TOC%20ul%20ul%20%7B%0A%20%20%20%20margin%2Dleft%3A%20%2D2em%3B%0A%20%20%7D%0A%20%20%23TOC%20li%20%7B%0A%20%20%20%20line%2Dheight%3A%2016px%3B%0A%20%20%7D%0A%0Atable%20%7B%0A%20%20margin%3A%201em%20auto%3B%0A%20%20border%2Dwidth%3A%201px%3B%0A%20%20border%2Dcolor%3A%20%23DDDDDD%3B%0A%20%20border%2Dstyle%3A%20outset%3B%0A%20%20border%2Dcollapse%3A%20collapse%3B%0A%7D%0Atable%20th%20%7B%0A%20%20border%2Dwidth%3A%202px%3B%0A%20%20padding%3A%205px%3B%0A%20%20border%2Dstyle%3A%20inset%3B%0A%7D%0Atable%20td%20%7B%0A%20%20border%2Dwidth%3A%201px%3B%0A%20%20border%2Dstyle%3A%20inset%3B%0A%20%20line%2Dheight%3A%2018px%3B%0A%20%20padding%3A%205px%205px%3B%0A%7D%0Atable%2C%20table%20th%2C%20table%20td%20%7B%0A%20%20border%2Dleft%2Dstyle%3A%20none%3B%0A%20%20border%2Dright%2Dstyle%3A%20none%3B%0A%7D%0Atable%20thead%2C%20table%20tr%2Eeven%20%7B%0A%20%20background%2Dcolor%3A%20%23f7f7f7%3B%0A%7D%0A%0Ap%20%7B%0A%20%20margin%3A%200%2E5em%200%3B%0A%7D%0A%0Ablockquote%20%7B%0A%20%20background%2Dcolor%3A%20%23f6f6f6%3B%0A%20%20padding%3A%200%2E25em%200%2E75em%3B%0A%7D%0A%0Ahr%20%7B%0A%20%20border%2Dstyle%3A%20solid%3B%0A%20%20border%3A%20none%3B%0A%20%20border%2Dtop%3A%201px%20solid%20%23777%3B%0A%20%20margin%3A%2028px%200%3B%0A%7D%0A%0Adl%20%7B%0A%20%20margin%2Dleft%3A%200%3B%0A%7D%0A%20%20dl%20dd%20%7B%0A%20%20%20%20margin%2Dbottom%3A%2013px%3B%0A%20%20%20%20margin%2Dleft%3A%2013px%3B%0A%20%20%7D%0A%20%20dl%20dt%20%7B%0A%20%20%20%20font%2Dweight%3A%20bold%3B%0A%20%20%7D%0A%0Aul%20%7B%0A%20%20margin%2Dtop%3A%200%3B%0A%7D%0A%20%20ul%20li%20%7B%0A%20%20%20%20list%2Dstyle%3A%20circle%20outside%3B%0A%20%20%7D%0A%20%20ul%20ul%20%7B%0A%20%20%20%20margin%2Dbottom%3A%200%3B%0A%20%20%7D%0A%0Apre%2C%20code%20%7B%0A%20%20background%2Dcolor%3A%20%23f7f7f7%3B%0A%20%20border%2Dradius%3A%203px%3B%0A%20%20color%3A%20%23333%3B%0A%7D%0Apre%20%7B%0A%20%20white%2Dspace%3A%20pre%2Dwrap%3B%20%20%20%20%2F%2A%20Wrap%20long%20lines%20%2A%2F%0A%20%20border%2Dradius%3A%203px%3B%0A%20%20margin%3A%205px%200px%2010px%200px%3B%0A%20%20padding%3A%2010px%3B%0A%7D%0Apre%3Anot%28%5Bclass%5D%29%20%7B%0A%20%20background%2Dcolor%3A%20%23f7f7f7%3B%0A%7D%0A%0Acode%20%7B%0A%20%20font%2Dfamily%3A%20Consolas%2C%20Monaco%2C%20%27Courier%20New%27%2C%20monospace%3B%0A%20%20font%2Dsize%3A%2085%25%3B%0A%7D%0Ap%20%3E%20code%2C%20li%20%3E%20code%20%7B%0A%20%20padding%3A%202px%200px%3B%0A%7D%0A%0Adiv%2Efigure%20%7B%0A%20%20text%2Dalign%3A%20center%3B%0A%7D%0Aimg%20%7B%0A%20%20background%2Dcolor%3A%20%23FFFFFF%3B%0A%20%20padding%3A%202px%3B%0A%20%20border%3A%201px%20solid%20%23DDDDDD%3B%0A%20%20border%2Dradius%3A%203px%3B%0A%20%20border%3A%201px%20solid%20%23CCCCCC%3B%0A%20%20margin%3A%200%205px%3B%0A%7D%0A%0Ah1%20%7B%0A%20%20margin%2Dtop%3A%200%3B%0A%20%20font%2Dsize%3A%2035px%3B%0A%20%20line%2Dheight%3A%2040px%3B%0A%7D%0A%0Ah2%20%7B%0A%20%20border%2Dbottom%3A%204px%20solid%20%23f7f7f7%3B%0A%20%20padding%2Dtop%3A%2010px%3B%0A%20%20padding%2Dbottom%3A%202px%3B%0A%20%20font%2Dsize%3A%20145%25%3B%0A%7D%0A%0Ah3%20%7B%0A%20%20border%2Dbottom%3A%202px%20solid%20%23f7f7f7%3B%0A%20%20padding%2Dtop%3A%2010px%3B%0A%20%20font%2Dsize%3A%20120%25%3B%0A%7D%0A%0Ah4%20%7B%0A%20%20border%2Dbottom%3A%201px%20solid%20%23f7f7f7%3B%0A%20%20margin%2Dleft%3A%208px%3B%0A%20%20font%2Dsize%3A%20105%25%3B%0A%7D%0A%0Ah5%2C%20h6%20%7B%0A%20%20border%2Dbottom%3A%201px%20solid%20%23ccc%3B%0A%20%20font%2Dsize%3A%20105%25%3B%0A%7D%0A%0Aa%20%7B%0A%20%20color%3A%20%230033dd%3B%0A%20%20text%2Ddecoration%3A%20none%3B%0A%7D%0A%20%20a%3Ahover%20%7B%0A%20%20%20%20color%3A%20%236666ff%3B%20%7D%0A%20%20a%3Avisited%20%7B%0A%20%20%20%20color%3A%20%23800080%3B%20%7D%0A%20%20a%3Avisited%3Ahover%20%7B%0A%20%20%20%20color%3A%20%23BB00BB%3B%20%7D%0A%20%20a%5Bhref%5E%3D%22http%3A%22%5D%20%7B%0A%20%20%20%20text%2Ddecoration%3A%20underline%3B%20%7D%0A%20%20a%5Bhref%5E%3D%22https%3A%22%5D%20%7B%0A%20%20%20%20text%2Ddecoration%3A%20underline%3B%20%7D%0A%0A%2F%2A%20Class%20described%20in%20https%3A%2F%2Fbenjeffrey%2Ecom%2Fposts%2Fpandoc%2Dsyntax%2Dhighlighting%2Dcss%0A%20%20%20Colours%20from%20https%3A%2F%2Fgist%2Egithub%2Ecom%2Frobsimmons%2F1172277%20%2A%2F%0A%0Acode%20%3E%20span%2Ekw%20%7B%20color%3A%20%23555%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%2F%2A%20Keyword%20%2A%2F%0Acode%20%3E%20span%2Edt%20%7B%20color%3A%20%23902000%3B%20%7D%20%2F%2A%20DataType%20%2A%2F%0Acode%20%3E%20span%2Edv%20%7B%20color%3A%20%2340a070%3B%20%7D%20%2F%2A%20DecVal%20%28decimal%20values%29%20%2A%2F%0Acode%20%3E%20span%2Ebn%20%7B%20color%3A%20%23d14%3B%20%7D%20%2F%2A%20BaseN%20%2A%2F%0Acode%20%3E%20span%2Efl%20%7B%20color%3A%20%23d14%3B%20%7D%20%2F%2A%20Float%20%2A%2F%0Acode%20%3E%20span%2Ech%20%7B%20color%3A%20%23d14%3B%20%7D%20%2F%2A%20Char%20%2A%2F%0Acode%20%3E%20span%2Est%20%7B%20color%3A%20%23d14%3B%20%7D%20%2F%2A%20String%20%2A%2F%0Acode%20%3E%20span%2Eco%20%7B%20color%3A%20%23888888%3B%20font%2Dstyle%3A%20italic%3B%20%7D%20%2F%2A%20Comment%20%2A%2F%0Acode%20%3E%20span%2Eot%20%7B%20color%3A%20%23007020%3B%20%7D%20%2F%2A%20OtherToken%20%2A%2F%0Acode%20%3E%20span%2Eal%20%7B%20color%3A%20%23ff0000%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%2F%2A%20AlertToken%20%2A%2F%0Acode%20%3E%20span%2Efu%20%7B%20color%3A%20%23900%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%2F%2A%20Function%20calls%20%2A%2F%20%0Acode%20%3E%20span%2Eer%20%7B%20color%3A%20%23a61717%3B%20background%2Dcolor%3A%20%23e3d2d2%3B%20%7D%20%2F%2A%20ErrorTok%20%2A%2F%0A%0A" rel="stylesheet" type="text/css" />

</head>

<body>



<div id="header">
<h1 class="title">ssmc User Guide</h1>
<h4 class="author"><em>Bill Peterman</em></h4>
<h4 class="date"><em>2015-09-29</em></h4>
</div>


<div id="ssmc-an-r-package-for-assessing-source-sink-population-status-and-contribution-of-populations-to-the-metapopulation-using-demographic-connectivity-networks-and-monte-carlo-simulation" class="section level2">
<h2>ssmc: An R Package for assessing source-sink population status and contribution of populations to the metapopulation using demographic connectivity networks and Monte Carlo simulation</h2>
<div id="background" class="section level3">
<h3>Background</h3>
<p>The functions found in this package were originally developed as part of research focused on understanding source-sink populations dynamics of amphibians. This research was supported by the Department of Defense Strategic Environmental Research Development Program (<a href="https://www.serdp-estcp.org/" title="SERDP web page">SERDP</a>). This document is meant to serve as a supplement to the documentation found in the <code>help</code> files of <code>ssmc</code>. The math behind the model is presented below, but understanding the math is not essential to applying and the using the model. Please carefully read this User Guide as well as all documentation related to the functions in the R package.</p>
</div>
<div id="modeling-process" class="section level3">
<h3>Modeling process</h3>
<p>There 5 steps in the modeling process:</p>
<ol style="list-style-type: decimal">
<li>Select values for parameters
<ul>
<li>population size—assessed separately for each population</li>
<li>size of metamorphs<sup><strong>+</strong></sup>—assessed separately for each population</li>
<li>proportion of population that is philopatric—equivalent among all populations at each iteration</li>
<li>probability of surviving to adulthood<sup><strong>+</strong></sup>—equivalent among all populations at each iteration</li>
<li>dispersal distance—equivalent among all populations at each iteration</li>
</ul></li>
<li>Determine probability of dispersal (see ‘Calculating diserpsal’ below)</li>
<li>Determine the number of individuals dispersing between populations</li>
<li>Determine the contribution and influence of each pond to the metapopuation</li>
<li>Repeat steps 1–4 for the specified number of Monte Carlo iterations</li>
</ol>
<p>Each of the above stochastic variables is drawn from a normal distribution with a mean and standard deviation that is specified based on your system. At each Monte Carlo iteration, different values are drawn.</p>
<p>After all iterations are complete, the ratio of immigrant:philopatric (<span class="math">\(\frac{i}{p}\)</span>) individuals is assessed. If <span class="math">\(\frac{i}{p}&gt;1\)</span>, the population is considered a sink, if <span class="math">\(\frac{i}{p} \leqslant 1\)</span> the population is considered a source. This evaluation is made for each iteration, and the frequency at which a population acts as a source or sink is evaluated. Additionally, the average number of emigrants, immigrants, and philopatric individuals is determined for each population, as well as the average contribution of each population to the metapopulation.</p>
<p><sup><strong>+</strong></sup> The size of metamorphs, if specified, is used to determine the population-specific probability of survival to adulthood using the equation: <span class="math">\[logit(survival) = -1.366 + 0.87 * size,\]</span> If metamorph size is not provided, then survival probability is drawn from distribution and will be uniform across all populations. The above equation come from Altwegg &amp; Reyer (<a href="http://onlinelibrary.wiley.com/doi/10.1111/j.0014-3820.2003.tb00298.x/abstract" title="Link to paper">2003</a>)</p>
</div>
<div id="calculating-dispersal" class="section level3">
<h3>Calculating dispersal</h3>
<p>The probability of successful dispersal from population <span class="math">\(i\)</span> to population <span class="math">\(j\)</span> is calculated as: <span class="math">\[m_{ij}= exp(-\alpha d_{ij} ),\]</span> for <span class="math">\(j\neq i\)</span> and <span class="math">\(m_{ii}=0\)</span>. Average dispersal distance is <span class="math">\(1/\alpha\)</span> and <span class="math">\(d_{ij}\)</span> is the distance between populations <span class="math">\(i\)</span> and <span class="math">\(j\)</span>. The probabilities of <span class="math">\(m_{ij}\)</span> are standardized so that rows <span class="math">\(i\)</span> sum to one by</p>
<p><span class="math">\[m'_{ij}= \frac{m_{ij}} {\sum_{i}^{j}}. \]</span></p>
<p>The number of individuals, <span class="math">\(n\)</span>, dispersing from population <span class="math">\(i\)</span> to <span class="math">\(j\)</span> is then determined using a multinomial distribution such that</p>
<p><span class="math">\[P(n_1, n_2, ..., n_k) = \frac {N!}{(n_1! n_2! ... n_k! )} * (p_{1}^{n_1} p_{2}^{n_2} ... p_{k}^{n_k}) \]</span></p>
<p>where</p>
<ul>
<li><span class="math">\(N\)</span> is the number of emigrants from <span class="math">\(i\)</span></li>
<li><span class="math">\(k\)</span> is the total number of populations that individuals could disperse to</li>
<li><span class="math">\(n_{ij}\)</span> is the number of dispersers from population <span class="math">\(i\)</span> to <span class="math">\(j\)</span></li>
<li><span class="math">\(p_{ij}\)</span> is the probability dispersing from population <span class="math">\(i\)</span> to <span class="math">\(j\)</span>, as determined from <span class="math">\(m'_{ij}\)</span></li>
</ul>
<p>Values <span class="math">\(n_{ij}\)</span> are components of the landscape matrix <span class="math">\(\mathrm{M}_{ij}\)</span>. Summing across columns, <span class="math">\(j\)</span>, of matrix <strong>M</strong> gives the total number of emigrants leaving population <span class="math">\(i\)</span>, while summing across rows, <span class="math">\(i\)</span>, gives the total number of immigrants entering population <span class="math">\(j\)</span>.</p>
<p><span class="math">\[emigrants_i = \sum_{n=1}^{j} \mathrm{M}_{ij} \]</span> <span class="math">\[immigrants_j = \sum_{n=1}^{i} \mathrm{M}_{ij} \]</span></p>
</div>
<div id="determining-contribution-to-the-metapopulation" class="section level3">
<h3>Determining contribution to the metapopulation</h3>
<p>Metapopulation capacity, as defined by Hanski &amp; Ovaskainen (<a href="http://www.nature.com/nature/journal/v404/n6779/full/404755a0.html&quot;Link%20to%20paper&quot;">2000</a>), is a measure that encompasses the arrangement of habitat patches as well as the size of those patches. Size is used as a proxy for population carrying capacity, which is replaced with estimated abundance in the model formulation of <code>ssmc</code>. Following Hanski &amp; Ovaskainen (<a href="http://www.nature.com/nature/journal/v404/n6779/full/404755a0.html&quot;Link%20to%20paper&quot;">2000</a>), we assess the metapopulation capacity, <span class="math">\(\lambda_\mathrm{M}\)</span>, which is the leading eigen-value of landscape matrix <strong>M</strong>. The individual contributions of each population, <span class="math">\(i\)</span>, to <span class="math">\(\lambda_\mathrm{M}\)</span> is <span class="math">\[\lambda_i \equiv x_{i}^{2} \lambda_\mathrm{M},\]</span> where <span class="math">\(x_i\)</span> is the <span class="math">\(i\)</span>th element in the leading eigenvector of the landscape matrix <strong>M</strong>. As such, <span class="math">\(\lambda_i\)</span> measures the contribution of each population to metapopulation capacity. The importance of population <span class="math">\(i\)</span> can be further assessed by removing it from the metapopulation network and recalculating <span class="math">\(\lambda_\mathrm{M}\)</span>. Alternatively, it is possible to assess the contribution of newly created habtiat to the metapopulation by adding new population <span class="math">\(i\)</span> to the network. This is what the functions <code>site.analysis</code> and <code>best.locale</code> of the R package <code>ssmc</code> seek to do.</p>
</div>
</div>
<div id="setup" class="section level2">
<h2>Setup</h2>
<div id="install-necessary-software-and-packages" class="section level4">
<h4>Install necessary software and packages</h4>
<p>You will also need to have <a href="http://www.r-project.org/" title="R downloads">R &gt;= v3.0</a> installed. I would highly recommend installing <a href="https://www.rstudio.com/ide/download/" title="R Studio download">R studio</a> when working with R.</p>
<p><em><strong>Getting the R Package</strong></em></p>
<p>First, install <code>ssmc</code> from GitHub. This will require the <code>devtools</code> package</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Install 'devtools' package, if needed</span>
if(!(<span class="st">&quot;devtools&quot;</span> %in%<span class="st"> </span><span class="kw">list.files</span>(<span class="kw">.libPaths</span>()))) {
    <span class="kw">install.packages</span>(<span class="st">&quot;devtools&quot;</span>, 
                     <span class="dt">repo =</span> <span class="st">&quot;http://cran.rstudio.com&quot;</span>, 
                     <span class="dt">dep =</span> <span class="ot">TRUE</span>) 
}

<span class="kw">library</span>(devtools) <span class="co"># Loads devtools</span>

<span class="kw">install_github</span>(<span class="st">&quot;wpeterman/ssmc&quot;</span>) <span class="co"># Download package</span></code></pre>
<p>Load <code>ssmc</code> and clear your workspace.</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(ssmc)
<span class="kw">rm</span>(<span class="dt">list =</span> <span class="kw">ls</span>())</code></pre>
</div>
<div id="assessing-the-source-sink-status-and-importance-of-populations-to-the-metapopulation" class="section level4">
<h4>Assessing the source-sink status and importance of populations to the metapopulation</h4>
<p>The <code>ssmc</code> package comes with a simulted sample data set called <code>site.dat</code>. After loading the <code>ssmc</code> package, you can explore the structure and format of the data file.</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">str</span>(site.dat)</code></pre>
<pre><code>## 'data.frame':    25 obs. of  7 variables:
##  $ site    : int  1 2 3 4 5 6 7 8 9 10 ...
##  $ x       : num  25.1 93.5 32.3 45.2 96.2 ...
##  $ y       : num  0.435 0.783 0.192 0.301 0.572 ...
##  $ ab.mean : num  0 76.5 0 204.4 241.3 ...
##  $ ab.sd   : num  0 5.4825 0 1.5547 0.0809 ...
##  $ svl.mean: num  1.057 0.4552 -0.4095 0.0623 -0.9316 ...
##  $ svl.sd  : num  0.369 1.363 1.402 0.721 0.802 ...</code></pre>
<p>There are seven variables included in the data frame. This format is not essential to using the functions of <code>ssmc</code>, as paramter values are individually specified for each function.</p>
<p>To assess source-sink status of existing populations, use the <code>site.analysis</code> function. Following the example provided in the help documentation, run the function.</p>
<pre class="sourceCode r"><code class="sourceCode r">site_results &lt;-<span class="st"> </span><span class="kw">site.analysis</span>(<span class="dt">sites =</span> site.dat[,<span class="dv">1</span>:<span class="dv">3</span>],
                              <span class="dt">pop.abun =</span> site.dat[,<span class="dv">4</span>:<span class="dv">5</span>],
                              <span class="dt">met.size =</span> site.dat[,<span class="dv">6</span>:<span class="dv">7</span>],
                              <span class="dt">prop.philo =</span> <span class="fl">0.95</span>,   
                              <span class="dt">sd.philo =</span> <span class="fl">0.05</span>,
                              <span class="dt">lower.upper_philo=</span><span class="kw">c</span>(<span class="dt">lower=</span><span class="dv">0</span>, <span class="dt">upper=</span><span class="dv">1</span>),
                              <span class="dt">lower.upper_survive =</span> <span class="kw">c</span>(<span class="dt">lower=</span><span class="dv">0</span>, <span class="dt">upper=</span><span class="dv">1</span>),
                              <span class="dt">dispersal =</span> <span class="dv">25</span>,
                              <span class="dt">sd.dispersal =</span> <span class="dv">10</span>,
                              <span class="dt">lower.upper_dispersal =</span> <span class="kw">c</span>(<span class="dt">lower=</span><span class="dv">10</span>, <span class="dt">upper=</span><span class="ot">Inf</span>),
                              <span class="dt">iterations =</span> <span class="dv">5</span>,
                              <span class="dt">seed =</span> <span class="dv">123</span>)</code></pre>
<p>The results of <code>site.analysis</code> contain both a summary data frame as well as the raw data from each Monte Carlo iteration. The summary data frame can be exported and sorted based on the desired rank criteria using the <code>ssmc_summary</code> function.</p>
<pre class="sourceCode r"><code class="sourceCode r">site_summary &lt;-<span class="st"> </span><span class="kw">ssmc_summary</span>(<span class="dt">ssmc_results =</span> site_results,
                             <span class="dt">sort =</span> <span class="st">&quot;avg_rank&quot;</span>)
<span class="kw">str</span>(site_summary)</code></pre>
<pre><code>## 'data.frame':    25 obs. of  14 variables:
##  $ site     : int  8 19 23 5 18 15 1 17 20 24 ...
##  $ x        : num  70.83 78.16 90.49 96.15 7.29 ...
##  $ y        : num  0.437 0.925 0.915 0.572 0.804 ...
##  $ immig    : num  0.4 0.8 1.8 0.6 0.8 0.4 1.2 0.8 0.8 1.6 ...
##  $ philo    : num  34 38 27 40.6 51 54.4 0 8.8 0 3.6 ...
##  $ emig     : num  4 3.6 1.6 1.4 3.6 4.2 0 0.6 0 0 ...
##  $ pct_immig: num  0.0133 0.0221 0.0632 0.0134 0.017 ...
##  $ pct_sink : num  0 0 0 0 0 0 1 0 1 0.2 ...
##  $ pct_src  : num  1 1 1 1 1 1 0 1 0 0.8 ...
##  $ cont_lam : num  0.1986 0.0851 0.0108 0.0253 0.0368 ...
##  $ rank_cont: num  2 3 7 6 4 8 1 9 18.5 18.5 ...
##  $ delta_lam: num  -3.45 -3.28 -4.61 -3.43 -2.7 ...
##  $ rank_lamb: num  2 4 1 3 5 7 19 14 6 8 ...
##  $ avg_rank : int  1 2 3 4 4 6 7 8 9 10 ...</code></pre>
<p>It is possible to sort the summary data frame using one of the three rank variables generated during the simulation:</p>
<ol style="list-style-type: decimal">
<li>‘rank_cont’: Populations are ranked based on their average contribution, <span class="math">\(\lambda_i\)</span>, to metapopulation capacity</li>
<li>‘rank_lamb’: Populations are ranked based on the average change in metapopulation capacity, <span class="math">\(\Delta \lambda_\mathrm{M}\)</span></li>
<li>‘avg_rank’: The average of ‘rank_cont’ and ‘rank_lamb’</li>
</ol>
<p>Elements of the summary data frame include:</p>
<ol style="list-style-type: decimal">
<li><code>immig</code>: The average number of immigrants entering each population</li>
<li><code>philo</code>: The average number of philopatric individuals</li>
<li><code>emig</code>: The average number of emigrants dispersing from a population</li>
<li><code>pct_immig</code>: Average percentage of a population that is comprised of immigrants</li>
<li><code>pct_sink</code>: The frequency that a population acted as a sink (i.e. <span class="math">\(\frac{i}{p} &gt; 1\)</span>) across all simulations</li>
<li><code>pct_src</code>: The frequency that a population acted as a source (i.e. <span class="math">\(\frac{i}{p} \leqslant 1\)</span>) across all simulations</li>
<li><code>cont_lamb</code>: The contribution of each location to the metapopulation (<span class="math">\(\lambda_i\)</span>)</li>
<li><code>rank_cont</code>: The rank order importance of each location to the metapopulation</li>
<li><code>delta_lam</code>: The change in the value of the the leading eigen value of the connectivity matrix when population <span class="math">\(i\)</span> is removed, which is interpreted as the metapopulation capacity. This is calculated as the log ratio of values <span class="math">\(\Delta \lambda_\mathrm{M} = log(lambda.new / lambda.old)\)</span></li>
<li><code>rank_lamb</code>: The rank order importance of each location to metapopulation capacity;</li>
<li><code>avg_rank</code>: The rank importance of each potential location, determined by averaging <code>rank_cont</code> and <code>rank_lamb</code></li>
</ol>
<p><strong>Comments on using <code>site.analysis</code></strong></p>
<ol style="list-style-type: decimal">
<li>This is a rather computationally intensive process, so the number of Monte Carlo iterations has been kept to a minimum for example purposes. It is highly recommended that 1,000–10,000 iterations be used when conducting real analyses.</li>
<li>Because <code>met.size</code> was specified, there is no need to specify <code>prop.survive</code> and <code>sd.survive</code>.</li>
<li><code>met.size</code>, if provided, must be in standard units with a mean of zero and standard deviation of one</li>
<li>The units for dispersal distance are arbitrary, but must correspond with the distances that will be calculated between populations based on the xy coordinates. The model was originally applied to populations with xy coordinates in UTM, and dispersal distances in meters.</li>
<li>The <code>lower.upper_</code> parameters are used to specify lower and upper threshold values when sampling from a normal distribution.</li>
</ol>
</div>
<div id="assessing-the-potential-of-a-new-or-restored-population-to-contribute-to-the-metapopulation" class="section level4">
<h4>Assessing the potential of a new or restored population to contribute to the metapopulation</h4>
<p>The use of the <code>best.locale</code> function is identical to <code>site.analysis</code> except that a data frame of potential sites is provided to be evaluated as part of the metapopulation network. <code>potential.dat</code> is provided with the package as an example of a potential location data frame.</p>
<pre class="sourceCode r"><code class="sourceCode r">best_results &lt;-<span class="st"> </span><span class="kw">best.locale</span>(<span class="dt">sites =</span> site.dat[,<span class="dv">1</span>:<span class="dv">3</span>],
                            <span class="dt">potential.sites =</span> potential.dat,
                            <span class="dt">pop.abun =</span> site.dat[,<span class="dv">4</span>:<span class="dv">5</span>],
                            <span class="dt">met.size =</span> site.dat[,<span class="dv">6</span>:<span class="dv">7</span>],
                            <span class="dt">prop.philo =</span> <span class="fl">0.95</span>,
                            <span class="dt">sd.philo =</span> <span class="fl">0.05</span>,
                            <span class="dt">lower.upper_philo=</span><span class="kw">c</span>(<span class="dt">lower=</span><span class="dv">0</span>, <span class="dt">upper=</span><span class="dv">1</span>),
                            <span class="dt">lower.upper_survive =</span> <span class="kw">c</span>(<span class="dt">lower=</span><span class="dv">0</span>, <span class="dt">upper=</span><span class="dv">1</span>),
                            <span class="dt">dispersal =</span> <span class="dv">25</span>,
                            <span class="dt">sd.dispersal =</span> <span class="dv">10</span>,
                            <span class="dt">lower.upper_dispersal =</span> <span class="kw">c</span>(<span class="dt">lower=</span><span class="dv">10</span>, <span class="dt">upper=</span><span class="ot">Inf</span>),
                            <span class="dt">iterations =</span> <span class="dv">5</span>,
                            <span class="dt">seed =</span> <span class="dv">123</span>)</code></pre>
<p>At each Monte Carlo iteration, the function evaluates the contribution of each potential location in contributing to <span class="math">\(\lambda_i\)</span> as well as the metapopulation capacity, <span class="math">\(\lambda_\mathrm{M}\)</span>, of the network with the population included. Because these are hpothetical populations with no abundance, size, or survival parameters, these parameters are set to the mean value of all non-zero populations for that iteration of the analysis. As such, each potential location is evaluated as if it were an ‘average’ population on the landscape.</p>
<p>The output from the <code>best.locale</code> analysis is similar to that of <code>site.analysis</code> and the summary data frame can again be extracted and sorted using <code>ssmc_summary</code></p>
<pre class="sourceCode r"><code class="sourceCode r">best_summary &lt;-<span class="st"> </span><span class="kw">ssmc_summary</span>(<span class="dt">ssmc_results =</span> best_results,
                             <span class="dt">sort =</span> <span class="st">&quot;avg_rank&quot;</span>)
<span class="kw">str</span>(best_summary)</code></pre>
<pre><code>## 'data.frame':    25 obs. of  8 variables:
##  $ site     : int  6 1 12 16 2 10 14 15 17 18 ...
##  $ x        : num  99.42 25.45 6.64 34.05 62.17 ...
##  $ y        : num  6.05 75.19 55.1 74.65 53.28 ...
##  $ cont_lam : num  0.0207 0.2007 0.2007 0.2007 0.2007 ...
##  $ rank_cont: num  9 2.5 2.5 2.5 2.5 14 14 14 14 14 ...
##  $ lambda   : num  2.12 1.88 1.88 1.88 1.5 ...
##  $ rank_lamb: num  3 13 13 13 17 6.5 6.5 6.5 6.5 6.5 ...
##  $ avg_rank : int  1 2 2 2 5 6 6 6 6 6 ...</code></pre>
</div>
<div id="citations" class="section level3">
<h3>Citations</h3>
<p>Altwegg, R., and H.-U. Reyer. 2003. Patterns of natural selection on size at metamorphosis in water frogs. Evolution 57:872–882.</p>
<p>Hanski, I., and O. Ovaskainen. 2000. The metapopulation capacity of a fragmented landscape. Nature 404:755–758.</p>
</div>
</div>



<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
