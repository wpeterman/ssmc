<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8">
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />

<meta name="viewport" content="width=device-width, initial-scale=1">

<meta name="author" content="Bill Peterman" />

<meta name="date" content="2016-06-03" />

<title>ssmc User Guide</title>



<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
div.sourceCode { overflow-x: auto; }
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; } /* Keyword */
code > span.dt { color: #902000; } /* DataType */
code > span.dv { color: #40a070; } /* DecVal */
code > span.bn { color: #40a070; } /* BaseN */
code > span.fl { color: #40a070; } /* Float */
code > span.ch { color: #4070a0; } /* Char */
code > span.st { color: #4070a0; } /* String */
code > span.co { color: #60a0b0; font-style: italic; } /* Comment */
code > span.ot { color: #007020; } /* Other */
code > span.al { color: #ff0000; font-weight: bold; } /* Alert */
code > span.fu { color: #06287e; } /* Function */
code > span.er { color: #ff0000; font-weight: bold; } /* Error */
code > span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
code > span.cn { color: #880000; } /* Constant */
code > span.sc { color: #4070a0; } /* SpecialChar */
code > span.vs { color: #4070a0; } /* VerbatimString */
code > span.ss { color: #bb6688; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { color: #19177c; } /* Variable */
code > span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code > span.op { color: #666666; } /* Operator */
code > span.bu { } /* BuiltIn */
code > span.ex { } /* Extension */
code > span.pp { color: #bc7a00; } /* Preprocessor */
code > span.at { color: #7d9029; } /* Attribute */
code > span.do { color: #ba2121; font-style: italic; } /* Documentation */
code > span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code > span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code > span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
</style>



<link href="data:text/css;charset=utf-8,body%20%7B%0Abackground%2Dcolor%3A%20%23fff%3B%0Amargin%3A%201em%20auto%3B%0Amax%2Dwidth%3A%20700px%3B%0Aoverflow%3A%20visible%3B%0Apadding%2Dleft%3A%202em%3B%0Apadding%2Dright%3A%202em%3B%0Afont%2Dfamily%3A%20%22Open%20Sans%22%2C%20%22Helvetica%20Neue%22%2C%20Helvetica%2C%20Arial%2C%20sans%2Dserif%3B%0Afont%2Dsize%3A%2014px%3B%0Aline%2Dheight%3A%201%2E35%3B%0A%7D%0A%23header%20%7B%0Atext%2Dalign%3A%20center%3B%0A%7D%0A%23TOC%20%7B%0Aclear%3A%20both%3B%0Amargin%3A%200%200%2010px%2010px%3B%0Apadding%3A%204px%3B%0Awidth%3A%20400px%3B%0Aborder%3A%201px%20solid%20%23CCCCCC%3B%0Aborder%2Dradius%3A%205px%3B%0Abackground%2Dcolor%3A%20%23f6f6f6%3B%0Afont%2Dsize%3A%2013px%3B%0Aline%2Dheight%3A%201%2E3%3B%0A%7D%0A%23TOC%20%2Etoctitle%20%7B%0Afont%2Dweight%3A%20bold%3B%0Afont%2Dsize%3A%2015px%3B%0Amargin%2Dleft%3A%205px%3B%0A%7D%0A%23TOC%20ul%20%7B%0Apadding%2Dleft%3A%2040px%3B%0Amargin%2Dleft%3A%20%2D1%2E5em%3B%0Amargin%2Dtop%3A%205px%3B%0Amargin%2Dbottom%3A%205px%3B%0A%7D%0A%23TOC%20ul%20ul%20%7B%0Amargin%2Dleft%3A%20%2D2em%3B%0A%7D%0A%23TOC%20li%20%7B%0Aline%2Dheight%3A%2016px%3B%0A%7D%0Atable%20%7B%0Amargin%3A%201em%20auto%3B%0Aborder%2Dwidth%3A%201px%3B%0Aborder%2Dcolor%3A%20%23DDDDDD%3B%0Aborder%2Dstyle%3A%20outset%3B%0Aborder%2Dcollapse%3A%20collapse%3B%0A%7D%0Atable%20th%20%7B%0Aborder%2Dwidth%3A%202px%3B%0Apadding%3A%205px%3B%0Aborder%2Dstyle%3A%20inset%3B%0A%7D%0Atable%20td%20%7B%0Aborder%2Dwidth%3A%201px%3B%0Aborder%2Dstyle%3A%20inset%3B%0Aline%2Dheight%3A%2018px%3B%0Apadding%3A%205px%205px%3B%0A%7D%0Atable%2C%20table%20th%2C%20table%20td%20%7B%0Aborder%2Dleft%2Dstyle%3A%20none%3B%0Aborder%2Dright%2Dstyle%3A%20none%3B%0A%7D%0Atable%20thead%2C%20table%20tr%2Eeven%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0A%7D%0Ap%20%7B%0Amargin%3A%200%2E5em%200%3B%0A%7D%0Ablockquote%20%7B%0Abackground%2Dcolor%3A%20%23f6f6f6%3B%0Apadding%3A%200%2E25em%200%2E75em%3B%0A%7D%0Ahr%20%7B%0Aborder%2Dstyle%3A%20solid%3B%0Aborder%3A%20none%3B%0Aborder%2Dtop%3A%201px%20solid%20%23777%3B%0Amargin%3A%2028px%200%3B%0A%7D%0Adl%20%7B%0Amargin%2Dleft%3A%200%3B%0A%7D%0Adl%20dd%20%7B%0Amargin%2Dbottom%3A%2013px%3B%0Amargin%2Dleft%3A%2013px%3B%0A%7D%0Adl%20dt%20%7B%0Afont%2Dweight%3A%20bold%3B%0A%7D%0Aul%20%7B%0Amargin%2Dtop%3A%200%3B%0A%7D%0Aul%20li%20%7B%0Alist%2Dstyle%3A%20circle%20outside%3B%0A%7D%0Aul%20ul%20%7B%0Amargin%2Dbottom%3A%200%3B%0A%7D%0Apre%2C%20code%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0Aborder%2Dradius%3A%203px%3B%0Acolor%3A%20%23333%3B%0Awhite%2Dspace%3A%20pre%2Dwrap%3B%20%0A%7D%0Apre%20%7B%0Aborder%2Dradius%3A%203px%3B%0Amargin%3A%205px%200px%2010px%200px%3B%0Apadding%3A%2010px%3B%0A%7D%0Apre%3Anot%28%5Bclass%5D%29%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0A%7D%0Acode%20%7B%0Afont%2Dfamily%3A%20Consolas%2C%20Monaco%2C%20%27Courier%20New%27%2C%20monospace%3B%0Afont%2Dsize%3A%2085%25%3B%0A%7D%0Ap%20%3E%20code%2C%20li%20%3E%20code%20%7B%0Apadding%3A%202px%200px%3B%0A%7D%0Adiv%2Efigure%20%7B%0Atext%2Dalign%3A%20center%3B%0A%7D%0Aimg%20%7B%0Abackground%2Dcolor%3A%20%23FFFFFF%3B%0Apadding%3A%202px%3B%0Aborder%3A%201px%20solid%20%23DDDDDD%3B%0Aborder%2Dradius%3A%203px%3B%0Aborder%3A%201px%20solid%20%23CCCCCC%3B%0Amargin%3A%200%205px%3B%0A%7D%0Ah1%20%7B%0Amargin%2Dtop%3A%200%3B%0Afont%2Dsize%3A%2035px%3B%0Aline%2Dheight%3A%2040px%3B%0A%7D%0Ah2%20%7B%0Aborder%2Dbottom%3A%204px%20solid%20%23f7f7f7%3B%0Apadding%2Dtop%3A%2010px%3B%0Apadding%2Dbottom%3A%202px%3B%0Afont%2Dsize%3A%20145%25%3B%0A%7D%0Ah3%20%7B%0Aborder%2Dbottom%3A%202px%20solid%20%23f7f7f7%3B%0Apadding%2Dtop%3A%2010px%3B%0Afont%2Dsize%3A%20120%25%3B%0A%7D%0Ah4%20%7B%0Aborder%2Dbottom%3A%201px%20solid%20%23f7f7f7%3B%0Amargin%2Dleft%3A%208px%3B%0Afont%2Dsize%3A%20105%25%3B%0A%7D%0Ah5%2C%20h6%20%7B%0Aborder%2Dbottom%3A%201px%20solid%20%23ccc%3B%0Afont%2Dsize%3A%20105%25%3B%0A%7D%0Aa%20%7B%0Acolor%3A%20%230033dd%3B%0Atext%2Ddecoration%3A%20none%3B%0A%7D%0Aa%3Ahover%20%7B%0Acolor%3A%20%236666ff%3B%20%7D%0Aa%3Avisited%20%7B%0Acolor%3A%20%23800080%3B%20%7D%0Aa%3Avisited%3Ahover%20%7B%0Acolor%3A%20%23BB00BB%3B%20%7D%0Aa%5Bhref%5E%3D%22http%3A%22%5D%20%7B%0Atext%2Ddecoration%3A%20underline%3B%20%7D%0Aa%5Bhref%5E%3D%22https%3A%22%5D%20%7B%0Atext%2Ddecoration%3A%20underline%3B%20%7D%0A%0Acode%20%3E%20span%2Ekw%20%7B%20color%3A%20%23555%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%0Acode%20%3E%20span%2Edt%20%7B%20color%3A%20%23902000%3B%20%7D%20%0Acode%20%3E%20span%2Edv%20%7B%20color%3A%20%2340a070%3B%20%7D%20%0Acode%20%3E%20span%2Ebn%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Efl%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Ech%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Est%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Eco%20%7B%20color%3A%20%23888888%3B%20font%2Dstyle%3A%20italic%3B%20%7D%20%0Acode%20%3E%20span%2Eot%20%7B%20color%3A%20%23007020%3B%20%7D%20%0Acode%20%3E%20span%2Eal%20%7B%20color%3A%20%23ff0000%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%0Acode%20%3E%20span%2Efu%20%7B%20color%3A%20%23900%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%20code%20%3E%20span%2Eer%20%7B%20color%3A%20%23a61717%3B%20background%2Dcolor%3A%20%23e3d2d2%3B%20%7D%20%0A" rel="stylesheet" type="text/css" />

</head>

<body>




<h1 class="title toc-ignore">ssmc User Guide</h1>
<h4 class="author"><em>Bill Peterman</em></h4>
<h4 class="date"><em>2016-06-03</em></h4>



<div id="ssmc-an-r-package-for-assessing-source-sink-population-status-and-contribution-of-populations-to-the-metapopulation-using-demographic-connectivity-networks-and-monte-carlo-simulation" class="section level2">
<h2>ssmc: An R Package for assessing source-sink population status and contribution of populations to the metapopulation using demographic connectivity networks and Monte Carlo simulation</h2>
<div id="background" class="section level3">
<h3>Background</h3>
<p>The functions found in this package were originally developed as part of research focused on understanding source-sink populations dynamics of amphibians. This research was supported by the Department of Defense Strategic Environmental Research Development Program (<a href="https://www.serdp-estcp.org/" title="SERDP web page">SERDP</a>; Project #RC-2155). This document is meant to serve as a supplement to the documentation found in the <code>help</code> files of <code>ssmc</code>. The math behind the model is presented below, but understanding the math is not essential to applying and the using the model. Please carefully read this User Guide as well as all documentation related to the functions in the R package.</p>
</div>
<div id="modeling-process" class="section level3">
<h3>Modeling process</h3>
<p>There are 5 steps in the modeling process:</p>
<ol style="list-style-type: decimal">
<li>Select values for parameters
<ul>
<li>population size – assessed separately for each population</li>
<li>size of metamorphs<sup><strong>+</strong></sup> – assessed separately for each population</li>
<li>proportion of population that is philopatric – equivalent among all populations at each iteration</li>
<li>probability of surviving to adulthood<sup><strong>+</strong></sup> – equivalent among all populations at each iteration</li>
<li>dispersal distance – equivalent among all populations at each iteration</li>
</ul></li>
<li>Determine probability of dispersal (see ‘Calculating diserpsal’ below)</li>
<li>Determine the number of individuals dispersing between populations</li>
<li>Determine the contribution and influence of each pond to the mean metapopuation lifetime</li>
<li>Repeat steps 1–4 for the specified number of Monte Carlo iterations</li>
</ol>
<p>Each of the above stochastic variables is drawn from a normal distribution with a mean and standard deviation that is specified based on your system. At each Monte Carlo iteration, different values are drawn.</p>
<p>After all iterations are complete, the ratio of immigrant:philopatric (<span class="math inline">\(\frac{i}{p}\)</span>) individuals is assessed. If <span class="math inline">\(\frac{i}{p}&gt;1\)</span>, the population is considered a sink, if <span class="math inline">\(\frac{i}{p} \leqslant 1\)</span> the population is considered a source. This evaluation is made for each iteration, and the frequency at which a population acts as a source or sink is then determined Additionally, the average number of emigrants, immigrants, and philopatric individuals is determined for each population, as well as the change in mean metapopulation lifetime when each population is removed.</p>
<p><sup><strong>+</strong></sup> The size of metamorphs, if specified, is used to determine the population-specific probability of survival to adulthood using the equation: <span class="math display">\[logit(survival) = -1.366 + 0.87 * size,\]</span> If metamorph size is not provided, then survival probability is drawn from a distribution and will be uniform across all populations. The above equation comes from Altwegg &amp; Reyer (<a href="http://onlinelibrary.wiley.com/doi/10.1111/j.0014-3820.2003.tb00298.x/abstract" title="Link to paper">2003</a>)</p>
</div>
<div id="calculating-dispersal" class="section level3">
<h3>Calculating dispersal</h3>
<p>The probability of successful dispersal from population <span class="math inline">\(i\)</span> to population <span class="math inline">\(j\)</span> is calculated as: <span class="math display">\[m_{ij}= exp(-\alpha d_{ij} ),\]</span> for <span class="math inline">\(j\neq i\)</span> and <span class="math inline">\(m_{ii}=0\)</span>. Average dispersal distance is <span class="math inline">\(1/\alpha\)</span> and <span class="math inline">\(d_{ij}\)</span> is the distance between populations <span class="math inline">\(i\)</span> and <span class="math inline">\(j\)</span>. The probabilities of <span class="math inline">\(m_{ij}\)</span> are standardized so that rows <span class="math inline">\(i\)</span> sum to one by</p>
<p><span class="math display">\[m'_{ij}= \frac{m_{ij}} {\sum_{i}^{j}}. \]</span></p>
<p>The number of individuals, <span class="math inline">\(n\)</span>, dispersing from population <span class="math inline">\(i\)</span> to <span class="math inline">\(j\)</span> is then determined using a multinomial distribution such that</p>
<p><span class="math display">\[P(n_1, n_2, ..., n_k) = \frac {N!}{(n_1! n_2! ... n_k! )} * (p_{1}^{n_1} p_{2}^{n_2} ... p_{k}^{n_k}) \]</span></p>
<p>where</p>
<ul>
<li><span class="math inline">\(N\)</span> is the number of emigrants from <span class="math inline">\(i\)</span></li>
<li><span class="math inline">\(k\)</span> is the total number of populations that individuals could disperse to</li>
<li><span class="math inline">\(n_{ij}\)</span> is the number of dispersers from population <span class="math inline">\(i\)</span> to <span class="math inline">\(j\)</span></li>
<li><span class="math inline">\(p_{ij}\)</span> is the probability dispersing from population <span class="math inline">\(i\)</span> to <span class="math inline">\(j\)</span>, as determined from <span class="math inline">\(m'_{ij}\)</span></li>
</ul>
<p>Values <span class="math inline">\(n_{ij}\)</span> are components of the landscape matrix <span class="math inline">\(\mathrm{M}_{ij}\)</span>. Summing across columns, <span class="math inline">\(j\)</span>, of matrix <strong>M</strong> gives the total number of emigrants leaving population <span class="math inline">\(i\)</span>, while summing across rows, <span class="math inline">\(i\)</span>, gives the total number of immigrants entering population <span class="math inline">\(j\)</span>.</p>
<p><span class="math display">\[emigrants_i = \sum_{n=1}^{j} \mathrm{M}_{ij} \]</span> <span class="math display">\[immigrants_j = \sum_{n=1}^{i} \mathrm{M}_{ij} \]</span></p>
</div>
<div id="determining-effect-on-metapopulation-mean-lifetime-mmlt" class="section level3">
<h3>Determining effect on Metapopulation Mean Lifetime (MMLT)</h3>
<p>Metapopulation Mean Lifetime is a global measure that represents the persistance or viability of a metapopulation (Drechsler <a href="http://www.sciencedirect.com/science/article/pii/S0025556408002046">2009</a>), and was adapted from work by Frank &amp; Wissel (<a href="http://link.springer.com/article/10.1023%2FA%3A1008054906030">1998</a>, <a href="http://www.jstor.org/stable/info/10.1086/428293">2002</a>). MMLT has been further adapted by Kininmonth et al. (<a href="http://www.int-res.com/abstracts/meps/v417/p139-149/">2010</a>) for applications with graph theory. This framework approach is sensitive to network topology, specifically spatial locations and size of populations. Calculation of MMLT is as follows: First an extintion rate <span class="math inline">\(v_i\)</span> is calculated as: <span class="math display">\[v_i = \varepsilon A_{i}^{-\eta} ,\]</span> where <span class="math inline">\(\varepsilon\)</span> (default = 1) and <span class="math inline">\(\eta\)</span> (default = 0.5) are parameters relating the local extinction rate to patch area, <span class="math inline">\(A\)</span>. Then, based on in-degree (<span class="math inline">\(immigrants_i\)</span>) and out-degree (<span class="math inline">\(emigrants_i\)</span>) edge weights from the network graph, <span class="math inline">\(C_i^{(in)}\)</span> (colonizability) and <span class="math inline">\(C_i^{(out)}\)</span> (colonization strength) are calculated: <span class="math display">\[C_i^{(in)} = immigrants_i\]</span> <span class="math display">\[C_i^{(out)} = emigrants_i\]</span></p>
<p>Colonizability and colonization strength are then multiplied by the expected lifetime of a patch, <span class="math inline">\(1/v_i\)</span>.</p>
<p><span class="math display">\[u_i^{(out)} = \frac {C_i^{(out)}}{v_i}\]</span> <span class="math display">\[u_i^{(in)} = \frac {C_i^{(in)}}{v_i}.\]</span></p>
<p>The colonization-extinction ratio of patch <span class="math inline">\(i\)</span> is the harmonic mean of <span class="math inline">\(u_i^{(out)}\)</span> and <span class="math inline">\(u_i^{(in)}\)</span>: <span class="math display">\[U_i = (\frac{1}{2}(u_i^{(in)})^{-2} + \frac {1}{2}(u_i^{(out)})^{-2})^\frac {-1}{2},\]</span></p>
<p>which is then aggregated for the entire network: <span class="math display">\[q = \prod_{i=1}^{N} \{\mathrm{max}(U_i, \sqrt{2})\}^{1/N}.\]</span></p>
<p>The local extinction rates, <span class="math inline">\(v_i\)</span>, are also aggregated as a geometric mean: <span class="math display">\[v = \prod_{i=1}^{N} v_i^{1/N}.\]</span></p>
<p>The metapopulation mean lifetime is then: <span class="math display">\[\mathrm{MMLT} = \frac {1}{v} \sum_{i=1}^{N} \sum_{k=1}^{N} \frac {1}{k} \frac{(N - i)!}{(N - k)!} \frac {1}{(N - 1)^{k-1}}q^{k-1}.\]</span></p>
<p>However, because of the large number of patches likely to be used with this approach, the approximating equation of Drechsler (<a href="http://www.sciencedirect.com/science/article/pii/S0025556408002046">2009</a>) <span class="math display">\[ln(vT) \approx N(\frac {1}{q} + ln(q)-1).\]</span></p>
<p>The importance of population <span class="math inline">\(i\)</span> to the metapopulation mean lifetime is then determined as the amount of change (<span class="math inline">\(\Delta \mathrm{MMLT}\)</span>) in MMLT when population <span class="math inline">\(i\)</span> is removed: <span class="math display">\[\Delta \mathrm{MMLT} = \frac {(log_{10}(\mathrm{MMLT.new} + 1) - log_{10}(\mathrm{MMLT.old} + 1))} {log_{10}(\mathrm{MMLT.old} + 1)}\]</span></p>
<p>The assessment of population contribution to the metapopulation as measured through <span class="math inline">\(\Delta \mathrm{MMLT}\)</span> is implemented through the <code>site.analysis</code> functions. In addition to calculating <span class="math inline">\(\Delta \mathrm{MMLT}\)</span> for exisitng populations, it is possible to assess the impact of creating new habtiat or restoring existing habitat. This approach calcualtes MMLT when potential population <span class="math inline">\(i\)</span> is created or restored, and the average MMLT over all Monte-Carlo iterations is then multiplied by the frequency that population <span class="math inline">\(i\)</span> is colonized by 2 or more individuals. This adjustment ensures that populations that are infrequently colonized are given lower priority for creation or restoration. The <code>best.locale</code> function allows for these assessments.</p>
</div>
</div>
<div id="setup" class="section level2">
<h2>Setup</h2>
<div id="install-necessary-software-and-packages" class="section level4">
<h4>Install necessary software and packages</h4>
<p>You will also need to have <a href="http://www.r-project.org/" title="R downloads">R &gt;= v3.0</a> installed. I would highly recommend installing <a href="https://www.rstudio.com/ide/download/" title="R Studio download">R studio</a> when working with R.</p>
<p><em><strong>Getting the R Package</strong></em></p>
<p>First, install <code>ssmc</code> from GitHub. This will require the <code>devtools</code> package</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Install 'devtools' package, if needed</span>
if(!(<span class="st">&quot;devtools&quot;</span> %in%<span class="st"> </span><span class="kw">list.files</span>(<span class="kw">.libPaths</span>()))) {
    <span class="kw">install.packages</span>(<span class="st">&quot;devtools&quot;</span>, 
                     <span class="dt">repo =</span> <span class="st">&quot;http://cran.rstudio.com&quot;</span>, 
                     <span class="dt">dep =</span> <span class="ot">TRUE</span>) 
}

<span class="kw">library</span>(devtools) <span class="co"># Loads devtools</span>

<span class="kw">install_github</span>(<span class="st">&quot;wpeterman/ssmc&quot;</span>) <span class="co"># Download package</span></code></pre></div>
<p>Load <code>ssmc</code> and clear your workspace.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(ssmc)
<span class="kw">rm</span>(<span class="dt">list =</span> <span class="kw">ls</span>())</code></pre></div>
</div>
<div id="assessing-the-source-sink-status-and-importance-of-populations-to-the-metapopulation" class="section level4">
<h4>Assessing the source-sink status and importance of populations to the metapopulation</h4>
<p>The <code>ssmc</code> package comes with a simulted sample data set called <code>site.dat</code>. After loading the <code>ssmc</code> package, you can explore the structure and format of the data file.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">str</span>(site.dat)</code></pre></div>
<pre><code>## 'data.frame':    25 obs. of  8 variables:
##  $ site    : int  1 2 3 4 5 6 7 8 9 10 ...
##  $ x       : num  17.1 13.1 82 15.5 53.3 ...
##  $ y       : num  0.0656 0.1824 0.4946 0.38 0.0204 ...
##  $ A       : num  74.5 15.9 48.9 74.2 68.4 ...
##  $ ab.mean : num  0 67.6 0 0 0 ...
##  $ ab.sd   : num  0 15.1 0 0 0 ...
##  $ svl.mean: num  -0.19 -0.783 -0.551 1.381 -0.132 ...
##  $ svl.sd  : num  0.188 0.012 0.905 0.185 0.847 ...</code></pre>
<p>There are seven variables included in the data frame. This format is not essential to using the functions of <code>ssmc</code>, as paramter values are individually specified for each function.</p>
<p>To assess source-sink status of existing populations, use the <code>site.analysis</code> function. Following the example provided in the help documentation, run the function.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">    site_results &lt;-<span class="st"> </span><span class="kw">site.analysis</span>(<span class="dt">sites =</span> site.dat[,<span class="dv">1</span>:<span class="dv">4</span>],
                                  <span class="dt">pop.abun =</span> site.dat[,<span class="dv">5</span>:<span class="dv">6</span>],
                                  <span class="dt">met.size =</span> site.dat[,<span class="dv">7</span>:<span class="dv">8</span>],
                                  <span class="dt">prop.philo =</span> <span class="fl">0.95</span>,
                                  <span class="dt">sd.philo =</span> <span class="fl">0.05</span>,
                                  <span class="dt">lower.upper_philo=</span><span class="kw">c</span>(<span class="dt">lower=</span><span class="dv">0</span>, <span class="dt">upper=</span><span class="dv">1</span>),
                                  <span class="dt">lower.upper_survive =</span> <span class="kw">c</span>(<span class="dt">lower=</span><span class="dv">0</span>, <span class="dt">upper=</span><span class="dv">1</span>),
                                  <span class="dt">dispersal =</span> <span class="dv">25</span>,
                                  <span class="dt">sd.dispersal =</span> <span class="dv">10</span>,
                                  <span class="dt">lower.upper_dispersal =</span> <span class="kw">c</span>(<span class="dt">lower=</span><span class="dv">10</span>, <span class="dt">upper=</span><span class="ot">Inf</span>),
                                  <span class="dt">eps =</span> <span class="dv">1</span>,
                                  <span class="dt">mu =</span> <span class="dv">2</span>,
                                  <span class="dt">eta =</span> <span class="fl">0.5</span>,
                                  <span class="dt">iterations =</span> <span class="dv">10</span>,
                                  <span class="dt">seed =</span> <span class="dv">123</span>)</code></pre></div>
<p>The results of <code>site.analysis</code> contain both a summary data frame as well as the raw data from each Monte Carlo iteration. The summary data frame can be exported and sorted based on the site/population rank using the <code>ssmc_summary</code> function.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">site_summary &lt;-<span class="st"> </span><span class="kw">ssmc_summary</span>(<span class="dt">ssmc_results =</span> site_results)
<span class="kw">str</span>(site_summary)</code></pre></div>
<pre><code>## 'data.frame':    25 obs. of  13 variables:
##  $ site     : int  20 16 14 12 13 7 24 15 25 10 ...
##  $ x        : num  28.69 38.95 42.08 4.33 58.1 ...
##  $ y        : num  0.949 0.462 0.457 0.744 0.246 ...
##  $ immig    : num  1.1 0.8 1 1.2 0.9 1.2 1.2 1.1 0.9 0.8 ...
##  $ philo    : num  58.6 86.3 8.4 13.3 17.2 5 8.6 79.6 6.4 8.8 ...
##  $ emig     : num  3.6 4.7 1.1 0.9 1 0.4 0.4 5.4 0.1 0.2 ...
##  $ in_deg   : num  0.9 0.8 0.7 1.1 0.9 1.2 1 1 0.8 0.8 ...
##  $ out_deg  : num  3.3 4 1 0.9 0.9 0.4 0.4 4.6 0.1 0.2 ...
##  $ pct_immig: num  0.0209 0.0169 0.0996 0.0787 0.0573 ...
##  $ pct_sink : num  0 0 0 0 0 0.2 0.1 0 0 0.3 ...
##  $ pct_src  : num  1 1 1 1 1 0.8 0.9 1 1 0.7 ...
##  $ delt_mmlt: num  -0.0867 -0.0623 -0.0492 -0.0439 -0.0426 ...
##  $ rank     : int  1 2 3 4 5 6 7 8 9 10 ...</code></pre>
<p>Elements of the summary data frame include:</p>
<ol style="list-style-type: decimal">
<li><code>immig</code>: The average number of immigrants entering each population</li>
<li><code>philo</code>: The average number of philopatric individuals</li>
<li><code>emig</code>: The average number of emigrants dispersing from a population</li>
<li><code>pct_immig</code>: Average percentage of a population that is comprised of immigrants</li>
<li><code>pct_sink</code>: The frequency that a population acted as a sink (i.e. <span class="math inline">\(\frac{i}{p} &gt; 1\)</span>) across all simulations</li>
<li><code>pct_src</code>: The frequency that a population acted as a source (i.e. <span class="math inline">\(\frac{i}{p} \leqslant 1\)</span>) across all simulations</li>
<li><code>delta_mmt</code>: The change in metapopulation mean lifetime when population <span class="math inline">\(i\)</span> is removed. This is calculated as: <span class="math display">\[\Delta \mathrm{MMLT} = (log_{10}(\mathrm{MMLT.new} + 1) - log_{10}(\mathrm{MMLT.old} + 1)) / log_{10}(\mathrm{MMLT.old} + 1)\]</span><br />
</li>
<li><code>rank</code>: The rank order importance of each location as determined by <span class="math inline">\(\Delta \mathrm{MMLT}\)</span></li>
</ol>
<p><strong>Comments on using <code>site.analysis</code></strong></p>
<ol style="list-style-type: decimal">
<li>This is a rather computationally intensive process, so the number of Monte Carlo iterations has been kept to a minimum for example purposes. It is highly recommended that 1,000–10,000 iterations be used when conducting real analyses.</li>
<li>Because <code>met.size</code> was specified, there is no need to specify <code>prop.survive</code> and <code>sd.survive</code>.</li>
<li><code>met.size</code>, if provided, must be in standard units with a mean of zero and standard deviation of one</li>
<li>The units for dispersal distance are arbitrary, but must correspond with the distances that will be calculated between populations based on the xy coordinates. The model was originally applied to populations with xy coordinates in UTM, and dispersal distances in meters.</li>
<li>The <code>lower.upper</code> parameters are used to specify lower and upper threshold values when sampling from a normal distribution.</li>
</ol>
</div>
<div id="assessing-the-potential-of-a-new-or-restored-population-to-contribute-to-the-metapopulation" class="section level4">
<h4>Assessing the potential of a new or restored population to contribute to the metapopulation</h4>
<p>The use of the <code>best.locale</code> function is identical to <code>site.analysis</code> except that a data frame of potential sites is provided to be evaluated as part of the metapopulation network. <code>potential.dat</code> is provided with the package as an example of a potential location data frame.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">best_results &lt;-<span class="st"> </span><span class="kw">best.locale</span>(<span class="dt">sites =</span> site.dat[,<span class="dv">1</span>:<span class="dv">4</span>],
                            <span class="dt">potential.sites =</span> potential.dat,
                            <span class="dt">pop.abun =</span> site.dat[,<span class="dv">5</span>:<span class="dv">6</span>],
                            <span class="dt">met.size =</span> site.dat[,<span class="dv">7</span>:<span class="dv">8</span>],
                            <span class="dt">prop.philo =</span> <span class="fl">0.95</span>,
                            <span class="dt">sd.philo =</span> <span class="fl">0.05</span>,
                            <span class="dt">lower.upper_philo=</span><span class="kw">c</span>(<span class="dt">lower=</span><span class="dv">0</span>, <span class="dt">upper=</span><span class="dv">1</span>),
                            <span class="dt">lower.upper_survive =</span> <span class="kw">c</span>(<span class="dt">lower=</span><span class="dv">0</span>, <span class="dt">upper=</span><span class="dv">1</span>),
                            <span class="dt">dispersal =</span> <span class="dv">25</span>,
                            <span class="dt">sd.dispersal =</span> <span class="dv">10</span>,
                            <span class="dt">lower.upper_dispersal =</span> <span class="kw">c</span>(<span class="dt">lower=</span><span class="dv">10</span>, <span class="dt">upper=</span><span class="ot">Inf</span>),
                            <span class="dt">eps =</span> <span class="dv">1</span>,
                            <span class="dt">mu =</span> <span class="dv">2</span>,
                            <span class="dt">eta =</span> <span class="fl">0.5</span>,
                            <span class="dt">iterations =</span> <span class="dv">10</span>,
                            <span class="dt">seed =</span> <span class="dv">123</span>)</code></pre></div>
<p>At each Monte Carlo iteration, the function evaluates the MMLT of the network with the population included. Because these are hpothetical populations with no abundance, size, or survival parameters, these parameters are set to the mean value of all non-zero populations for that iteration of the analysis. As such, each potential location is evaluated as if it were an ‘average’ population on the landscape.</p>
<p>The output from the <code>best.locale</code> analysis is similar to that of <code>site.analysis</code> and the summary data frame can again be extracted and sorted using <code>ssmc_summary</code></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">best_summary &lt;-<span class="st"> </span><span class="kw">ssmc_summary</span>(<span class="dt">ssmc_results =</span> best_results, <span class="st">'rank_adj'</span>)
<span class="kw">str</span>(best_summary)</code></pre></div>
<pre><code>## 'data.frame':    25 obs. of  8 variables:
##  $ site    : int  5 3 13 11 24 9 21 4 8 12 ...
##  $ x       : num  16.3 55.2 76.8 61.4 36.3 ...
##  $ y       : num  15.02 10.38 8.55 43.19 40.44 ...
##  $ mmlt    : num  0.436 0.428 0.422 0.422 0.42 ...
##  $ rank    : num  1 2 4 3 6 7 8 9 10 13 ...
##  $ frq_col : num  0.4 0.3 0.3 0.2 0.2 0.2 0.2 0.2 0.2 0.2 ...
##  $ mmlt_col: num  0.1745 0.1285 0.1266 0.0844 0.0839 ...
##  $ rank_adj: num  1 2 3 4 5 6 7 8 9 10 ...</code></pre>
<p>By specifying ‘rank_adj’, the summary output is sorted by the adjusted rank column (adjsuted for the frequency that a population is colonized by 2 or more individuals across all Monte-Carlo simulations).</p>
<p>Assessment of existing sites for restoration can be done by specifying <code>restore = TRUE</code> when running <code>best.locale</code>. In doing so, the function will identify all sites that currently have an abundance of zero, and will then assess MMLT when each is ‘restored’ to be an average population.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">restore_results &lt;-<span class="st"> </span><span class="kw">best.locale</span>(<span class="dt">sites =</span> site.dat[,<span class="dv">1</span>:<span class="dv">4</span>],
                               <span class="dt">restore =</span> <span class="ot">TRUE</span>,
                               <span class="dt">potential.sites =</span> potential.dat,
                               <span class="dt">pop.abun =</span> site.dat[,<span class="dv">5</span>:<span class="dv">6</span>],
                               <span class="dt">met.size =</span> site.dat[,<span class="dv">7</span>:<span class="dv">8</span>],
                               <span class="dt">prop.philo =</span> <span class="fl">0.95</span>,
                               <span class="dt">sd.philo =</span> <span class="fl">0.05</span>,
                               <span class="dt">lower.upper_philo=</span><span class="kw">c</span>(<span class="dt">lower=</span><span class="dv">0</span>, <span class="dt">upper=</span><span class="dv">1</span>),
                               <span class="dt">lower.upper_survive =</span> <span class="kw">c</span>(<span class="dt">lower=</span><span class="dv">0</span>, <span class="dt">upper=</span><span class="dv">1</span>),
                               <span class="dt">dispersal =</span> <span class="dv">25</span>,
                               <span class="dt">sd.dispersal =</span> <span class="dv">10</span>,
                               <span class="dt">lower.upper_dispersal =</span> <span class="kw">c</span>(<span class="dt">lower=</span><span class="dv">10</span>, <span class="dt">upper=</span><span class="ot">Inf</span>),
                               <span class="dt">eps =</span> <span class="dv">1</span>,
                               <span class="dt">mu =</span> <span class="dv">2</span>,
                               <span class="dt">eta =</span> <span class="fl">0.5</span>,
                               <span class="dt">iterations =</span> <span class="dv">10</span>,
                               <span class="dt">seed =</span> <span class="dv">123</span>)</code></pre></div>
<p>Summarize the output based on the adjsuted rank:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">restore_summary &lt;-<span class="st"> </span><span class="kw">ssmc_summary</span>(<span class="dt">ssmc_results =</span> restore_results, <span class="st">'rank_adj'</span>)
<span class="kw">str</span>(restore_summary)</code></pre></div>
<pre><code>## 'data.frame':    9 obs. of  8 variables:
##  $ site    : int  8 22 5 23 4 1 18 6 3
##  $ x       : num  20.9 60.2 53.3 17.4 15.5 ...
##  $ y       : num  0.2067 0.2905 0.0204 0.5194 0.38 ...
##  $ mmlt    : num  0.519 0.59 0.43 0.566 0.426 ...
##  $ rank    : num  3 1 6 2 7 8 4 5 9
##  $ frq_col : num  0.4 0.3 0.4 0.3 0.3 0.3 0.1 0.1 0.1
##  $ mmlt_col: num  0.208 0.177 0.172 0.17 0.128 ...
##  $ rank_adj: num  1 2 3 4 5 6 7 8 9</code></pre>
</div>
<div id="citations" class="section level3">
<h3>Citations</h3>
<p>Altwegg, R., and H.-U. Reyer. 2003. Patterns of natural selection on size at metamorphosis in water frogs. Evolution 57:872–882.</p>
<p>Drechsler, M. 2009. Predicting metapopulation lifetime from macroscopic network properties. Mathematical Biosciences 218:59–71.</p>
<p>Frank, K., and C. Wissel. 1998. Spatial aspects of metapopulation survival – from model results to rules of thumb for landscape management. Landscape Ecology 13:363–379.</p>
<p>Frank, K., and C. Wissel. 2002. A formula for the mean lifetime of metapopulations in heterogeneous landscapes. The American Naturalist 159:530–552.</p>
<p>Kininmonth, S., M. Drechsler, K. Johst, and H. P. Possingham. 2010. Metapopulation mean life time within complex networks. Marine Ecology Progress Series 417:139–149.</p>
</div>
</div>



<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
